import torch

desktop_path = 'C:\\Users\\bellavista\\Desktop\\'
model_path = desktop_path + 'model_state_dict.pth'
scripted_model_path = desktop_path + 'scripted_model.pth'

try:
    # 检查文件是否存在
    import os
    if not os.path.exists(model_path):
        raise FileNotFoundError(f"Model file not found at {model_path}")
    if not os.path.exists(scripted_model_path):
        raise FileNotFoundError(f"Scripted model file not found at {scripted_model_path}")

    # 加载普通模型（state_dict）
    loaded_model = torch.load(model_path, map_location=torch.device('cpu'))
    # 注意：这里假设loaded_model已经是完整的模型实例
    # 如果只是state_dict，需要先创建模型架构再加载
    loaded_model.eval()

    # 加载Scripted模型
    try:
        loaded_scripted_model = torch.jit.load(scripted_model_path, map_location='cpu')
        loaded_scripted_model.eval()
    except RuntimeError as e:
        print(f"Warning: Could not load scripted model - {e}")
        loaded_scripted_model = None

    # 测试加载的模型
    x = torch.randn((1, 3, 32, 32))
    with torch.no_grad():
        out = loaded_model(x)
        print("Loaded model output shape:", out.shape)

        if loaded_scripted_model is not None:
            out_scripted = loaded_scripted_model(x)
            print("Scripted model output shape:", out_scripted.shape)

except Exception as e:
    print(f"Error loading model: {e}")
